---
import type { CompanySettingData } from '@/types'

import Clock from '@/components/icon/Clock.vue'
import CreditCard from '@/components/icon/CreditCard.vue'
import Email from '@/components/icon/Email.vue'
import Facebook from '@/components/icon/Facebook.vue'
import Instagram from '@/components/icon/Instagram.vue'
import Line from '@/components/icon/Line.vue'
import MapPin from '@/components/icon/MapPin.vue'
import Phone from '@/components/icon/Phone.vue'
import Telegram from '@/components/icon/Telegram.vue'
import Threads from '@/components/icon/Threads.vue'
import X from '@/components/icon/X.vue'
import FooterLink from '@/components/ui/FooterLink.vue'
import { createNestedT, getLinkByLocale } from '@/utils/i18n'

const t = await createNestedT()

const year = new Date().getFullYear()

export interface Props {
    class?: astroHTML.JSX.HTMLAttributes['class']
    companySetting?: CompanySettingData | null
}

const {
    companySetting = null,
} = Astro.props

// 檢查是否有任何社群媒體連結
const hasSocialMedia = companySetting?.fb_link ||
                      companySetting?.ig_link ||
                      companySetting?.line_link ||
                      companySetting?.twitter_link ||
                      companySetting?.tg_link ||
                      companySetting?.threads_link
---

<footer class="relative overflow-hidden bg-theme-bg text-theme-text border-t border-[var(--theme-border,#e5e5e5)] pt-8 pb-4 before:absolute before:inset-0 before:bg-gradient-to-br before:from-[rgba(212,175,55,0.05)] before:to-[rgba(212,175,55,0.02)] before:pointer-events-none">
    <div class="relative z-10 px-4 md:px-8 lg:px-16 lg:max-w-[1400px] lg:mx-auto">
        <div class="grid md:grid-cols-[auto_auto] md:justify-between grid-cols-1 gap-y-8 gap-x-12 pb-4">
            <!-- 左側：公司資訊 -->
            <div class="animate-fadeInUp grid grid-cols-1 md:max-w-xl lg:max-w-2xl">
                <div class="mb-6">
                    <div class="text-2xl md:text-3xl font-bold text-primary-600 mb-1 tracking-wide">
                        {companySetting?.name}
                    </div>
                    <div class="text-base font-medium text-[var(--theme-text-secondary,#666666)] tracking-[2px] uppercase">
                        HEAVEN SPA
                    </div>
                </div>
                <p class="text-sm md:text-base leading-relaxed text-[var(--theme-text-secondary,#666666)] mb-8">
                    {companySetting?.description}
                </p>

                <!-- 聯絡資訊 -->
                <div class="gap-6 grid grid-cols-1 md:grid-cols-2">
                    {companySetting?.phone_1 && (
                        <div class="hover:cursor-pointer flex items-center justify-start gap-3 text-sm hover:text-primary-600 transition-colors duration-300">
                            <div class="text-base opacity-80">
                                <Phone size="20" />
                            </div>
                            <a href={`tel:${companySetting.phone_1}`}>
                                {companySetting.phone_1}
                            </a>
                        </div>
                    )}
                    {companySetting?.address_1 && (
                        <div class="hover:cursor-pointer flex items-center justify-start gap-3 text-sm hover:text-color-primary-600 transition-colors duration-300">
                            <div class="text-base opacity-80">
                                <MapPin size="20" />
                            </div>
                            <a
                              href={`https://maps.google.com/?q=${encodeURIComponent(companySetting.address_1)}`}
                              target="_blank"
                              rel="noopener noreferrer"
                            >
                                {companySetting.address_1}
                            </a>
                        </div>
                    )}
                    {companySetting?.email_1 && (
                        <div class="hover:cursor-pointer flex items-center justify-start gap-3 text-sm hover:text-[var(--color-primary-600,#c4a428)] transition-colors duration-300">
                            <div class="text-base opacity-80 flex-shrink-0">
                                <Email size="20" />
                            </div>
                            <a
                              href={`mailto:${companySetting.email_1}`}
                              class="break-all min-w-0"
                            >
                                {companySetting.email_1}
                            </a>
                        </div>
                    )}
                    {companySetting?.business_hours && (
                        <div class="hover:cursor-pointer flex items-center justify-start gap-3 text-sm hover:text--primary-600 transition-colors duration-300">
                            <div class="text-base opacity-80 flex-shrink-0">
                                <Clock size="20" />
                            </div>
                            <span class="whitespace-nowrap">{companySetting.business_hours}</span>
                        </div>
                    )}
                    {companySetting?.payment_method && (
                        <div class="hover:cursor-pointer flex items-center justify-start gap-3 text-sm hover:text-primary-600 transition-colors duration-300">
                            <div class="text-base opacity-80">
                                <CreditCard size="20" />
                            </div>
                            <span>{companySetting.payment_method}</span>
                        </div>
                    )}
                </div>
            </div>

            <!-- 右側：服務項目, 社群媒體, 法律與政策 -->
            <div class="grid grid-cols-2 sm:grid-cols-[auto_auto_auto] sm:justify-between gap-8">
                <!-- 服務項目 Section -->
                <div class=" animate-fadeInUp animation-delay-200 col-span-3 sm:col-span-1 mb-4 md:mb-0">
                    <h4 class="font-semibold md:h-10 h-4 text-[var(--color-primary-600,#c4a428)] mb-6 uppercase tracking-wider" style="font-size: clamp(14px, 1.2vw, 18px);">
                        <spa data-i18n="nav.sitemap">{t('nav.sitemap')}</spa>
                    </h4>
                    <ul class="grid grid-cols-2 gap-y-3 gap-x-4 md:grid-cols-1 md:gap-x-0">
                        <FooterLink href={getLinkByLocale('/about')} text={t('nav.about')} />
                        <FooterLink href={getLinkByLocale('/services')} text={t('nav.services')} />
                        <FooterLink href={getLinkByLocale('/team')} text={t('nav.team')} />
                        <FooterLink href={getLinkByLocale('/news')} text={t('nav.news')} />
                        <FooterLink href={getLinkByLocale('/faq')} text={t('nav.faq')} />
                        <FooterLink href={getLinkByLocale('/joinUs')} text={t('nav.joinUs')} />
                        <FooterLink href={getLinkByLocale('/business-partnership')} text={t('nav.business_partnership')} />
                    </ul>
                </div>

                <!-- 社群媒體 -->
                {hasSocialMedia && (
                    <div class="animate-fadeInUp animation-delay-400">
                        <h4 class="font-semibold md:h-10 h-4 text-[var(--color-primary-600,#c4a428)] mb-6 uppercase tracking-wider" style="font-size: clamp(14px, 1.2vw, 18px);">
                            {t('nav.social-media')}
                        </h4>
                        <ul class="space-y-3 grid grid-cols-1 md:gap-0">
                            {companySetting?.fb_link && (
                                <FooterLink
                                    href={companySetting.fb_link}
                                    text="Facebook"
                                    target="_blank"
                                    rel="noopener noreferrer"
                                    title="Facebook"
                                >
                                    <Facebook slot="icon" size="16" />
                                </FooterLink>
                            )}
                            {companySetting?.ig_link && (
                                <FooterLink
                                    href={companySetting.ig_link}
                                    text="Instagram"
                                    target="_blank"
                                    rel="noopener noreferrer"
                                    title="Instagram"
                                >
                                    <Instagram slot="icon" size="16" />
                                </FooterLink>
                            )}
                            {companySetting?.line_link && (
                                <FooterLink
                                    href={companySetting.line_link}
                                    text="Line"
                                    target="_blank"
                                    rel="noopener noreferrer"
                                    title="Line"
                                >
                                    <Line slot="icon" size="18" />
                                </FooterLink>
                            )}
                            {companySetting?.twitter_link && (
                                <FooterLink
                                    href={companySetting.twitter_link}
                                    text="Twitter"
                                    target="_blank"
                                    rel="noopener noreferrer"
                                    title="X (Twitter)"
                                >
                                    <X slot="icon" size="18" />
                                </FooterLink>
                            )}
                            {companySetting?.tg_link && (
                                <FooterLink
                                    href={companySetting.tg_link}
                                    text="Telegram"
                                    target="_blank"
                                    rel="noopener noreferrer"
                                    title="Telegram"
                                >
                                    <Telegram slot="icon" size="18" />
                                </FooterLink>
                            )}
                            {companySetting?.threads_link && (
                                <FooterLink
                                    href={companySetting.threads_link}
                                    text="Threads"
                                    target="_blank"
                                    rel="noopener noreferrer"
                                    title="Threads"
                                >
                                    <Threads slot="icon" size="20" />
                                </FooterLink>
                            )}
                        </ul>
                    </div>
                )}

                <!-- 法律與政策 -->
                <div class="animate-fadeInUp animation-delay-600 ">
                    <h4
                      class="nowrap break-keep md:h-10 h-4 font-semibold text-[var(--color-primary-600,#c4a428)] mb-6 uppercase tracking-wider"
                      style="font-size: clamp(14px, 1.2vw, 18px);"
                      data-i18n="footer.terms"
                    >
                        {t('footer.terms')}
                    </h4>
                    <ul class="space-y-3 grid grid-cols-1 gap-2 md:gap-0">
                        <FooterLink href={getLinkByLocale('/privacy')} text={t('footer.privacy-policy')} />
                        <FooterLink href={getLinkByLocale('/terms')} text={t('footer.terms-of-service')} />
                    </ul>
                </div>
            </div>
        </div>

        <!-- 底部版權資訊 -->
        <div class="border-t border-[var(--theme-border,#e5e5e5)] pt-4 text-center">
            <div class="flex flex-col md:flex-row justify-center items-center gap-2 md:gap-8 text-sm text-[var(--theme-text-secondary,#666666)]">
                <p>{year}. Heaven Spa. All Rights Reserved.</p>
            </div>
        </div>
    </div>

    <style>
        /* 動畫效果 */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-fadeInUp {
            animation: fadeInUp 0.6s ease forwards;
        }

        .animation-delay-200 {
            animation-delay: 0.2s;
        }

        .animation-delay-400 {
            animation-delay: 0.4s;
        }

        .animation-delay-600 {
            animation-delay: 0.6s;
        }


        /* 深色模式適配 */
        .dark-theme footer {
            background: var(--theme-bg, #000000) !important;
            color: var(--theme-text, #ffffff) !important;
        }

        .dark-theme footer::before {
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.1) 0%, rgba(212, 175, 55, 0.05) 100%) !important;
        }

        /* 深色模式下的社群媒體圖示 */
        .dark-theme footer svg {
            fill: #ffffff;
            color: #ffffff;
        }

        .dark-theme footer svg path {
            fill: #ffffff;
        }

        /* 深色模式下的懸停效果 */
        .dark-theme footer a:hover svg {
            fill: var(--color-primary-400, #d4af37) !important;
            color: var(--color-primary-400, #d4af37) !important;
        }

        .dark-theme footer a:hover svg path {
            fill: var(--color-primary-400, #d4af37) !important;
        }
    </style>
</footer>
